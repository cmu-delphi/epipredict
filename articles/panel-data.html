<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Using epipredict on non-epidemic panel data • epipredict</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Open_Sans-0.4.10/font.css" rel="stylesheet">
<link href="../deps/Source_Serif_Pro-0.4.10/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Using epipredict on non-epidemic panel data">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">epipredict</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.2.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/epipredict.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/custom_epiworkflows.html">Epiworkflows</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/backtesting.html">Backtesting</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/update.html">Using the add/update/remove/adjust functions</a></li>
    <li><a class="dropdown-item" href="../articles/panel-data.html">Using epipredict on non-epidemic panel data</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/cmu-delphi/epipredict/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Using epipredict on non-epidemic panel data</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/cmu-delphi/epipredict/blob/main/vignettes/panel-data.Rmd" class="external-link"><code>vignettes/panel-data.Rmd</code></a></small>
      <div class="d-none name"><code>panel-data.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/tidymodels/parsnip" class="external-link">parsnip</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/tidymodels/recipes" class="external-link">recipes</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/cmu-delphi/epiprocess" class="external-link">epiprocess</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/cmu-delphi/epipredict/" class="external-link">epipredict</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/cmu-delphi/epidatasets" class="external-link">epidatasets</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/get_theme.html" class="external-link">theme_set</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><a href="https://en.wikipedia.org/wiki/Panel_data" class="external-link">Panel data</a>, or
longitudinal data, contain cross-sectional measurements of subjects over
time. The <code>epipredict</code> package is most suitable for running
forecasters on epidemiological panel data. An example of this is the <a href="https://cmu-delphi.github.io/epidatasets/reference/covid_case_death_rates.html" class="external-link"><code>covid_case_death_rates</code></a>
dataset, which contains daily state-wise measures of
<code>case_rate</code> and <code>death_rate</code> for COVID-19 in
2021:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">covid_case_death_rates</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt; An `epi_df` object, 3 x 4 with metadata:</span></span>
<span><span class="co">#&gt; * geo_type  = state</span></span>
<span><span class="co">#&gt; * time_type = day</span></span>
<span><span class="co">#&gt; * as_of     = 2023-03-10</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 4</span></span></span>
<span><span class="co">#&gt;   <span style="font-weight: bold;">geo_value</span> <span style="font-weight: bold;">time_value</span> <span style="font-weight: bold;">case_rate</span> <span style="font-weight: bold;">death_rate</span></span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> ak        2020-12-31      35.9      0.158</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> al        2020-12-31      65.1      0.438</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> ar        2020-12-31      66.0      1.27</span></span></code></pre></div>
<p><code>epipredict</code> functions work with data in <a href="https://cmu-delphi.github.io/epiprocess/reference/epi_df.html" class="external-link"><code>epi_df</code></a>
format. Despite the stated goal and name of the package, other panel
datasets are also valid candidates for <code>epipredict</code>
functionality, as long as they are in <code>epi_df</code> format.</p>
<div class="section level2">
<h2 id="example-panel-data-overview">Example panel data overview<a class="anchor" aria-label="anchor" href="#example-panel-data-overview"></a>
</h2>
<p>In this vignette, we will demonstrate using <code>epipredict</code>
with employment panel data from Statistics Canada. We will be using <a href="https://www150.statcan.gc.ca/t1/tbl1/en/tv.action?pid=3710011501" class="external-link">Table
37-10-0115-01: Characteristics and median employment income of
longitudinal cohorts of postsecondary graduates two and five years after
graduation, by educational qualification and field of study (primary
groupings)</a>.</p>
<p>The full dataset contains yearly median employment income two and
five years after graduation, and number of graduates. The data is
stratified by variables such as geographic region (Canadian province),
education, and age group. The year range of the dataset is 2010 to 2017,
inclusive. The full dataset also contains metadata that describes the
quality of data collected. For demonstration purposes, we make the
following modifications to get a subset of the full dataset:</p>
<ul>
<li>Only keep provincial-level geographic region (the full data also has
“Canada” as a region)</li>
<li>Only keep “good” or better quality data rows, as indicated by the <a href="https://www.statcan.gc.ca/en/concepts/definitions/guide-symbol" class="external-link"><code>STATUS</code></a>
column</li>
<li>Choose a subset of covariates and aggregate across the remaining
ones. The chosen covariates are age group, and educational
qualification.</li>
</ul>
<p>To use this data with <code>epipredict</code>, we need to convert it
into <code>epi_df</code> format using
<code><a href="https://cmu-delphi.github.io/epiprocess/reference/epi_df.html" class="external-link">epiprocess::as_epi_df()</a></code> with additional keys. In our case,
the additional keys are <code>age_group</code>, and
<code>edu_qual</code>. Note that in the above modifications, we encoded
<code>time_value</code> as type <code>integer</code>. This lets us set
<code>time_type = "year"</code>, and ensures that lag and ahead
modifications later on are using the correct time units. See the
<code><a href="https://cmu-delphi.github.io/epiprocess/reference/epi_df.html" class="external-link">epiprocess::epi_df</a></code> for a list of all the
<code>time_type</code>s available.</p>
<p>Now, we are ready to use <code>grad_employ_subset</code> with
<code>epipredict</code>. Our <code>epi_df</code> contains 1,445 rows and
7 columns. Here is a quick summary of the columns in our
<code>epi_df</code>:</p>
<ul>
<li>
<code>time_value</code> (time value): year in <code>date</code>
format</li>
<li>
<code>geo_value</code> (geo value): province in Canada</li>
<li>
<code>num_graduates</code> (raw, time series value): number of
graduates</li>
<li>
<code>med_income_2y</code> (raw, time series value): median
employment income 2 years after graduation</li>
<li>
<code>med_income_5y</code> (raw, time series value): median
employment income 5 years after graduation</li>
<li>
<code>age_group</code> (key): one of two age groups, either 15 to 34
years, or 35 to 64 years</li>
<li>
<code>edu_qual</code> (key): one of 32 unique educational
qualifications, e.g., “Master’s diploma”</li>
</ul>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Rename for simplicity</span></span>
<span><span class="va">employ</span> <span class="op">&lt;-</span> <span class="va">grad_employ_subset</span></span>
<span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/sample_n.html" class="external-link">sample_n</a></span><span class="op">(</span><span class="va">employ</span>, <span class="fl">6</span><span class="op">)</span></span>
<span><span class="co">#&gt; An `epi_df` object, 6 x 7 with metadata:</span></span>
<span><span class="co">#&gt; * geo_type  = custom</span></span>
<span><span class="co">#&gt; * time_type = integer</span></span>
<span><span class="co">#&gt; * other_keys = age_group, edu_qual</span></span>
<span><span class="co">#&gt; * as_of     = 2024-09-18</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 7</span></span></span>
<span><span class="co">#&gt;   <span style="font-weight: bold;">geo_value</span>        <span style="font-weight: bold;">age_group</span>      <span style="font-weight: bold;">edu_qual</span>           <span style="font-weight: bold;">time_value</span> <span style="font-weight: bold;">num_graduates</span></span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>                   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Saskatchewan     35 to 64 years Undergraduate cer…       <span style="text-decoration: underline;">2</span>016           120</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> British Columbia 35 to 64 years Post-baccalaureat…       <span style="text-decoration: underline;">2</span>017           240</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> Saskatchewan     35 to 64 years Post-baccalaureat…       <span style="text-decoration: underline;">2</span>012            10</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> Quebec           15 to 34 years Master's certific…       <span style="text-decoration: underline;">2</span>010            80</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> British Columbia 35 to 64 years Career, technical…       <span style="text-decoration: underline;">2</span>012          <span style="text-decoration: underline;">3</span>060</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> New Brunswick    35 to 64 years Career, technical…       <span style="text-decoration: underline;">2</span>013           230</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 2 more variables: </span><span style="color: #949494; font-weight: bold;">med_income_2y</span><span style="color: #949494;"> &lt;dbl&gt;, </span><span style="color: #949494; font-weight: bold;">med_income_5y</span><span style="color: #949494;"> &lt;dbl&gt;</span></span></span></code></pre></div>
<p>In the following sections, we will go over pre-processing the data in
the <code>epi_recipe</code> framework, and estimating a model and making
predictions within the <code>epipredict</code> framework and using the
package’s canned forecasters.</p>
</div>
<div class="section level2">
<h2 id="autoregressive-ar-model-to-predict-number-of-graduates-in-a-year">Autoregressive (AR) model to predict number of graduates in a
year<a class="anchor" aria-label="anchor" href="#autoregressive-ar-model-to-predict-number-of-graduates-in-a-year"></a>
</h2>
<div class="section level3">
<h3 id="pre-processing">Pre-processing<a class="anchor" aria-label="anchor" href="#pre-processing"></a>
</h3>
<p>As a simple example, let’s work with the <code>num_graduates</code>
column for now. We will first pre-process by standardizing each numeric
column by the total within each group of keys. We do this since those
raw numeric values will vary greatly from province to province since
there are large differences in population.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">employ_small</span> <span class="op">&lt;-</span> <span class="va">employ</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">geo_value</span>, <span class="va">age_group</span>, <span class="va">edu_qual</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="co"># Select groups where there are complete time series values</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span> <span class="op">&gt;=</span> <span class="fl">6</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    num_graduates_prop <span class="op">=</span> <span class="va">num_graduates</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">num_graduates</span><span class="op">)</span>,</span>
<span>    med_income_2y_prop <span class="op">=</span> <span class="va">med_income_2y</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">med_income_2y</span><span class="op">)</span>,</span>
<span>    med_income_5y_prop <span class="op">=</span> <span class="va">med_income_5y</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">med_income_5y</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">employ_small</span><span class="op">)</span></span>
<span><span class="co">#&gt; An `epi_df` object, 6 x 10 with metadata:</span></span>
<span><span class="co">#&gt; * geo_type  = custom</span></span>
<span><span class="co">#&gt; * time_type = integer</span></span>
<span><span class="co">#&gt; * other_keys = age_group, edu_qual</span></span>
<span><span class="co">#&gt; * as_of     = 2024-09-18</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 10</span></span></span>
<span><span class="co">#&gt;   <span style="font-weight: bold;">geo_value</span>           <span style="font-weight: bold;">age_group</span>      <span style="font-weight: bold;">edu_qual</span>        <span style="font-weight: bold;">time_value</span> <span style="font-weight: bold;">num_graduates</span></span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>               <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>                <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Newfoundland and L… 15 to 34 years Career, techni…       <span style="text-decoration: underline;">2</span>010           430</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Newfoundland and L… 35 to 64 years Career, techni…       <span style="text-decoration: underline;">2</span>010           140</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> Newfoundland and L… 15 to 34 years Career, techni…       <span style="text-decoration: underline;">2</span>010           630</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> Newfoundland and L… 35 to 64 years Career, techni…       <span style="text-decoration: underline;">2</span>010           140</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> Newfoundland and L… 15 to 34 years Undergraduate …       <span style="text-decoration: underline;">2</span>010          <span style="text-decoration: underline;">1</span>050</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> Newfoundland and L… 35 to 64 years Undergraduate …       <span style="text-decoration: underline;">2</span>010           130</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 5 more variables: </span><span style="color: #949494; font-weight: bold;">med_income_2y</span><span style="color: #949494;"> &lt;dbl&gt;, </span><span style="color: #949494; font-weight: bold;">med_income_5y</span><span style="color: #949494;"> &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   </span><span style="color: #949494; font-weight: bold;">num_graduates_prop</span><span style="color: #949494;"> &lt;dbl&gt;, </span><span style="color: #949494; font-weight: bold;">med_income_2y_prop</span><span style="color: #949494;"> &lt;dbl&gt;, …</span></span></span></code></pre></div>
<p>Below is a visualization for a sample of the small data for British
Columbia and Ontario. Note that some groups do not have any time series
information since we filtered out all time series with incomplete
dates.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">employ_small</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">geo_value</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"British Columbia"</span>, <span class="st">"Ontario"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"degree"</span>, <span class="va">edu_qual</span>, fixed <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">geo_value</span>, <span class="va">time_value</span>, <span class="va">edu_qual</span>, <span class="va">age_group</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>num_graduates_prop <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">num_graduates_prop</span><span class="op">)</span>, .groups <span class="op">=</span> <span class="st">"drop"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time_value</span>, y <span class="op">=</span> <span class="va">num_graduates_prop</span>, color <span class="op">=</span> <span class="va">geo_value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_colour_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Cornflowerblue"</span>, <span class="st">"Orange"</span><span class="op">)</span>, name <span class="op">=</span> <span class="st">""</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span>rows <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">edu_qual</span><span class="op">)</span>, cols <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">age_group</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Year"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Percentage of gratuates"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span></span></code></pre></div>
<p><img src="panel-data_files/figure-html/employ-small-graph-1.png" width="90%" style="display: block; margin: auto;"></p>
<p>We will predict the standardized number of graduates (a proportion)
in the next year (time
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">t+1</annotation></semantics></math>)
using an autoregressive model with three lags (i.e., an AR(3) model).
Such a model is represented algebraically like this:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn><mo>,</mo><mi>i</mi><mi>j</mi><mi>k</mi></mrow></msub><mo>=</mo><msub><mi>α</mi><mn>0</mn></msub><mo>+</mo><msub><mi>α</mi><mn>1</mn></msub><msub><mi>y</mi><mrow><mi>t</mi><mi>i</mi><mi>j</mi><mi>k</mi></mrow></msub><mo>+</mo><msub><mi>α</mi><mn>2</mn></msub><msub><mi>y</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn><mo>,</mo><mi>i</mi><mi>j</mi><mi>k</mi></mrow></msub><mo>+</mo><msub><mi>α</mi><mn>3</mn></msub><msub><mi>y</mi><mrow><mi>t</mi><mo>−</mo><mn>2</mn><mo>,</mo><mi>i</mi><mi>j</mi><mi>k</mi></mrow></msub><mo>+</mo><msub><mi>ϵ</mi><mrow><mi>t</mi><mi>i</mi><mi>j</mi><mi>k</mi></mrow></msub></mrow><annotation encoding="application/x-tex">
  y_{t+1,ijk} =
  \alpha_0 + \alpha_1 y_{tijk} + \alpha_2 y_{t-1,ijk} + \alpha_3 y_{t-2,ijk} + \epsilon_{tijk}
</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>y</mi><mrow><mi>t</mi><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">y_{tij}</annotation></semantics></math>
is the proportion of graduates at time
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>
in location
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
and age group
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>
with education quality
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>.</p>
<p>In the pre-processing step, we need to create additional columns in
<code>employ</code> for each of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>y</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn><mo>,</mo><mi>i</mi><mi>j</mi><mi>k</mi></mrow></msub><annotation encoding="application/x-tex">y_{t+1,ijk}</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>y</mi><mrow><mi>t</mi><mi>i</mi><mi>j</mi><mi>k</mi></mrow></msub><annotation encoding="application/x-tex">y_{tijk}</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>y</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn><mo>,</mo><mi>i</mi><mi>j</mi><mi>k</mi></mrow></msub><annotation encoding="application/x-tex">y_{t-1,ijk}</annotation></semantics></math>,
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>y</mi><mrow><mi>t</mi><mo>−</mo><mn>2</mn><mo>,</mo><mi>i</mi><mi>j</mi><mi>k</mi></mrow></msub><annotation encoding="application/x-tex">y_{t-2,ijk}</annotation></semantics></math>.
We do this via an <code>epi_recipe</code>. Note that creating an
<code>epi_recipe</code> alone doesn’t add these outcome and predictor
columns; the recipe just stores the instructions for adding them.</p>
<p>Our <code>epi_recipe</code> should add one <code>ahead</code> column
representing
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>y</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn><mo>,</mo><mi>i</mi><mi>j</mi><mi>k</mi></mrow></msub><annotation encoding="application/x-tex">y_{t+1,ijk}</annotation></semantics></math>
and 3 <code>lag</code> columns representing
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>y</mi><mrow><mi>t</mi><mi>i</mi><mi>j</mi><mi>k</mi></mrow></msub><annotation encoding="application/x-tex">y_{tijk}</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>y</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn><mo>,</mo><mi>i</mi><mi>j</mi><mi>k</mi></mrow></msub><annotation encoding="application/x-tex">y_{t-1,ijk}</annotation></semantics></math>,
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>y</mi><mrow><mi>t</mi><mo>−</mo><mn>2</mn><mo>,</mo><mi>i</mi><mi>j</mi><mi>k</mi></mrow></msub><annotation encoding="application/x-tex">y_{t-2,ijk}</annotation></semantics></math>
(it’s more accurate to think of the 0th “lag” as the “current” value
with 2 lags, but that’s not quite how the processing works). Also note
that since we specified our <code>time_type</code> to be
<code>year</code>, our <code>lag</code> and <code>lead</code> values are
both in years.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">r</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/epi_recipe.html">epi_recipe</a></span><span class="op">(</span><span class="va">employ_small</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/step_epi_shift.html">step_epi_ahead</a></span><span class="op">(</span><span class="va">num_graduates_prop</span>, ahead <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/step_epi_shift.html">step_epi_lag</a></span><span class="op">(</span><span class="va">num_graduates_prop</span>, lag <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/step_epi_naomit.html">step_epi_naomit</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">r</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Epi Recipe</span> <span style="color: #00BBBB;">───────────────────────────────────────────────────────────────</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── Inputs</span></span>
<span><span class="co">#&gt; Number of variables by role</span></span>
<span><span class="co">#&gt; raw:        6</span></span>
<span><span class="co">#&gt; key:        2</span></span>
<span><span class="co">#&gt; geo_value:  1</span></span>
<span><span class="co">#&gt; time_value: 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── Operations</span></span>
<span><span class="co">#&gt; 1. Leading: <span style="color: #0000BB;">num_graduates_prop</span> by <span style="color: #0000BB;">1</span></span></span>
<span><span class="co">#&gt; 2. Lagging: <span style="color: #0000BB;">num_graduates_prop</span> by <span style="color: #0000BB;">0, 1, 2</span></span></span>
<span><span class="co">#&gt; 3. <span style="color: #00BBBB;">•</span> Removing rows with NA values in: <span style="color: #0000BB;">all_predictors()</span></span></span>
<span><span class="co">#&gt; 4. <span style="color: #00BBBB;">•</span> Removing rows with NA values in: <span style="color: #0000BB;">all_outcomes()</span></span></span></code></pre></div>
<p>Let’s apply this recipe using <code>prep</code> and <code>bake</code>
to generate and view the <code>lag</code> and <code>ahead</code>
columns.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Display a sample of the pre-processed data</span></span>
<span><span class="va">bake_and_show_sample</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">recipe</span>, <span class="va">data</span>, <span class="va">n</span> <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">recipe</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://recipes.tidymodels.org/reference/prep.html" class="external-link">prep</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://recipes.tidymodels.org/reference/bake.html" class="external-link">bake</a></span><span class="op">(</span>new_data <span class="op">=</span> <span class="va">data</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/sample_n.html" class="external-link">sample_n</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">r</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu">bake_and_show_sample</span><span class="op">(</span><span class="va">employ_small</span><span class="op">)</span></span>
<span><span class="co">#&gt; An `epi_df` object, 5 x 14 with metadata:</span></span>
<span><span class="co">#&gt; * geo_type  = custom</span></span>
<span><span class="co">#&gt; * time_type = integer</span></span>
<span><span class="co">#&gt; * other_keys = age_group, edu_qual</span></span>
<span><span class="co">#&gt; * as_of     = 2024-09-18</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 5 × 14</span></span></span>
<span><span class="co">#&gt;   <span style="font-weight: bold;">geo_value</span>        <span style="font-weight: bold;">age_group</span>      <span style="font-weight: bold;">edu_qual</span>           <span style="font-weight: bold;">time_value</span> <span style="font-weight: bold;">num_graduates</span></span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>                   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Ontario          35 to 64 years Master's diploma         <span style="text-decoration: underline;">2</span>012            40</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> British Columbia 15 to 34 years Undergraduate deg…       <span style="text-decoration: underline;">2</span>014         <span style="text-decoration: underline;">11</span>520</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> Alberta          35 to 64 years Career, technical…       <span style="text-decoration: underline;">2</span>013          <span style="text-decoration: underline;">1</span>270</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> Alberta          35 to 64 years Undergraduate deg…       <span style="text-decoration: underline;">2</span>016          <span style="text-decoration: underline;">1</span>050</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> Quebec           15 to 34 years Career, technical…       <span style="text-decoration: underline;">2</span>016          <span style="text-decoration: underline;">3</span>920</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 9 more variables: </span><span style="color: #949494; font-weight: bold;">med_income_2y</span><span style="color: #949494;"> &lt;dbl&gt;, </span><span style="color: #949494; font-weight: bold;">med_income_5y</span><span style="color: #949494;"> &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   </span><span style="color: #949494; font-weight: bold;">num_graduates_prop</span><span style="color: #949494;"> &lt;dbl&gt;, </span><span style="color: #949494; font-weight: bold;">med_income_2y_prop</span><span style="color: #949494;"> &lt;dbl&gt;, …</span></span></span></code></pre></div>
<p>We can see that the <code>prep</code> and <code>bake</code> steps
created new columns according to our <code>epi_recipe</code>:</p>
<ul>
<li>
<code>ahead_1_num_graduates_prop</code> corresponds to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>y</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn><mo>,</mo><mi>i</mi><mi>j</mi><mi>k</mi></mrow></msub><annotation encoding="application/x-tex">y_{t+1,ijk}</annotation></semantics></math>
</li>
<li>
<code>lag_0_num_graduates_prop</code>,
<code>lag_1_num_graduates_prop</code>, and
<code>lag_2_num_graduates_prop</code> correspond to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>y</mi><mrow><mi>t</mi><mi>i</mi><mi>j</mi><mi>k</mi></mrow></msub><annotation encoding="application/x-tex">y_{tijk}</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>y</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn><mo>,</mo><mi>i</mi><mi>j</mi><mi>k</mi></mrow></msub><annotation encoding="application/x-tex">y_{t-1,ijk}</annotation></semantics></math>,
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>y</mi><mrow><mi>t</mi><mo>−</mo><mn>2</mn><mo>,</mo><mi>i</mi><mi>j</mi><mi>k</mi></mrow></msub><annotation encoding="application/x-tex">y_{t-2,ijk}</annotation></semantics></math>
respectively.</li>
</ul>
</div>
<div class="section level3">
<h3 id="model-estimation-and-prediction">Model estimation and prediction<a class="anchor" aria-label="anchor" href="#model-estimation-and-prediction"></a>
</h3>
<p>Since our goal for now is to estimate a simple autoregressive model,
we can use <a href="https://parsnip.tidymodels.org/reference/linear_reg.html" class="external-link"><code>parsnip::linear_reg()</code></a>
with the default engine <code>lm</code>, which fits a linear regression
using ordinary least squares.</p>
<p>We will use <code>epi_workflow</code> with the
<code>epi_recipe</code> we defined in the pre-processing section along
with the <code><a href="https://parsnip.tidymodels.org/reference/linear_reg.html" class="external-link">parsnip::linear_reg()</a></code> model. Note that
<code>epi_workflow</code> is a container and doesn’t actually do the
fitting. We have to pass the workflow into <code><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit()</a></code> to get our
estimated model coefficients
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>α</mi><mo accent="true">̂</mo></mover><mi>i</mi></msub><mo>,</mo><mspace width="0.222em"></mspace><mi>i</mi><mo>=</mo><mn>0</mn><mo>,</mo><mi>.</mi><mi>.</mi><mi>.</mi><mo>,</mo><mn>3</mn></mrow><annotation encoding="application/x-tex">\widehat{\alpha}_i,\ i=0,...,3</annotation></semantics></math>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">wf_linreg</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/epi_workflow.html">epi_workflow</a></span><span class="op">(</span><span class="va">r</span>, <span class="fu"><a href="https://parsnip.tidymodels.org/reference/linear_reg.html" class="external-link">linear_reg</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="va">employ_small</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="https://hardhat.tidymodels.org/reference/hardhat-extract.html" class="external-link">extract_fit_engine</a></span><span class="op">(</span><span class="va">wf_linreg</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; stats::lm(formula = ..y ~ ., data = data)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;       Min        1Q    Median        3Q       Max </span></span>
<span><span class="co">#&gt; -0.104501 -0.013043 -0.002708  0.009289  0.210582 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;                           Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)               0.108532   0.006695  16.211  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; lag_0_num_graduates_prop  0.324251   0.037163   8.725  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; lag_1_num_graduates_prop  0.014190   0.038543   0.368 0.712848    </span></span>
<span><span class="co">#&gt; lag_2_num_graduates_prop -0.137378   0.036337  -3.781 0.000168 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 0.02993 on 777 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.1084, Adjusted R-squared:  0.1049 </span></span>
<span><span class="co">#&gt; F-statistic: 31.47 on 3 and 777 DF,  p-value: &lt; 2.2e-16</span></span></code></pre></div>
<p>This output tells us the coefficients of the fitted model; for
instance, the estimated intercept is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>α</mi><mo accent="true">̂</mo></mover><mn>0</mn></msub><mo>=</mo></mrow><annotation encoding="application/x-tex">\widehat{\alpha}_0 =</annotation></semantics></math>
0.109 and the coefficient for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>y</mi><mrow><mi>t</mi><mi>i</mi><mi>j</mi><mi>k</mi></mrow></msub><annotation encoding="application/x-tex">y_{tijk}</annotation></semantics></math>
is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>α</mi><mo accent="true">̂</mo></mover><mn>1</mn></msub><mo>=</mo></mrow><annotation encoding="application/x-tex">\widehat\alpha_1 =</annotation></semantics></math>
0.324. The summary also tells us that all estimated coefficients are
significantly different from zero. Extracting the 95% confidence
intervals for the coefficients also leads us to the same conclusion: all
the coefficient estimates are significantly different from 0.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="fu"><a href="https://hardhat.tidymodels.org/reference/hardhat-extract.html" class="external-link">extract_fit_engine</a></span><span class="op">(</span><span class="va">wf_linreg</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;                                2.5 %      97.5 %</span></span>
<span><span class="co">#&gt; (Intercept)               0.09538942  0.12167466</span></span>
<span><span class="co">#&gt; lag_0_num_graduates_prop  0.25130008  0.39720211</span></span>
<span><span class="co">#&gt; lag_1_num_graduates_prop -0.06147071  0.08985152</span></span>
<span><span class="co">#&gt; lag_2_num_graduates_prop -0.20870743 -0.06604791</span></span></code></pre></div>
<p>Now that we have our workflow, we can generate predictions from a
subset of our data. For this demo, we will predict the number of
graduates using the last 2 years of our dataset.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">latest</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_test_data.html">get_test_data</a></span><span class="op">(</span>recipe <span class="op">=</span> <span class="va">r</span>, x <span class="op">=</span> <span class="va">employ_small</span><span class="op">)</span></span>
<span><span class="va">preds</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">wf_linreg</span>, <span class="va">latest</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">.pred</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Display a sample of the prediction values, excluding NAs</span></span>
<span><span class="va">preds</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/sample_n.html" class="external-link">sample_n</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt; An `epi_df` object, 5 x 5 with metadata:</span></span>
<span><span class="co">#&gt; * geo_type  = custom</span></span>
<span><span class="co">#&gt; * time_type = integer</span></span>
<span><span class="co">#&gt; * other_keys = age_group, edu_qual</span></span>
<span><span class="co">#&gt; * as_of     = 2024-09-18</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 5 × 5</span></span></span>
<span><span class="co">#&gt;   <span style="font-weight: bold;">geo_value</span>                 <span style="font-weight: bold;">age_group</span>      <span style="font-weight: bold;">edu_qual</span>          <span style="font-weight: bold;">time_value</span> <span style="font-weight: bold;">.pred</span></span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                     <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>                  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> New Brunswick             15 to 34 years Professional deg…       <span style="text-decoration: underline;">2</span>017 0.141</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> British Columbia          15 to 34 years Career, technica…       <span style="text-decoration: underline;">2</span>017 0.134</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> Nova Scotia               15 to 34 years Master's degree         <span style="text-decoration: underline;">2</span>017 0.133</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> Ontario                   15 to 34 years Undergraduate ce…       <span style="text-decoration: underline;">2</span>017 0.161</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> Newfoundland and Labrador 15 to 34 years Master's degree         <span style="text-decoration: underline;">2</span>017 0.139</span></span></code></pre></div>
<p>We can do this using the <code>augment</code> function too. Note that
<code>predict</code> and <code>augment</code> both still return an
<code><a href="https://cmu-delphi.github.io/epiprocess/reference/epi_df.html" class="external-link">epiprocess::epi_df</a></code> with all of the keys that were present
in the original dataset.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://generics.r-lib.org/reference/augment.html" class="external-link">augment</a></span><span class="op">(</span><span class="va">wf_linreg</span>, <span class="va">latest</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/sample_n.html" class="external-link">sample_n</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt; An `epi_df` object, 5 x 11 with metadata:</span></span>
<span><span class="co">#&gt; * geo_type  = custom</span></span>
<span><span class="co">#&gt; * time_type = integer</span></span>
<span><span class="co">#&gt; * other_keys = age_group, edu_qual</span></span>
<span><span class="co">#&gt; * as_of     = 2024-09-18</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 5 × 11</span></span></span>
<span><span class="co">#&gt;   <span style="font-weight: bold;">geo_value</span>        <span style="font-weight: bold;">age_group</span>      <span style="font-weight: bold;">edu_qual</span>                  <span style="font-weight: bold;">time_value</span>  <span style="font-weight: bold;">.pred</span></span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>                          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> British Columbia 35 to 64 years Post-baccalaureate non-g…       <span style="text-decoration: underline;">2</span>017  0.143</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Saskatchewan     15 to 34 years Career, technical or pro…       <span style="text-decoration: underline;">2</span>015 <span style="color: #BB0000;">NA</span>    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> Manitoba         15 to 34 years Career, technical or pro…       <span style="text-decoration: underline;">2</span>016 <span style="color: #BB0000;">NA</span>    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> Saskatchewan     35 to 64 years Doctoral degree                 <span style="text-decoration: underline;">2</span>017  0.135</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> Manitoba         35 to 64 years Other career, technical …       <span style="text-decoration: underline;">2</span>016 <span style="color: #BB0000;">NA</span>    </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 6 more variables: </span><span style="color: #949494; font-weight: bold;">num_graduates</span><span style="color: #949494;"> &lt;dbl&gt;, </span><span style="color: #949494; font-weight: bold;">med_income_2y</span><span style="color: #949494;"> &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   </span><span style="color: #949494; font-weight: bold;">med_income_5y</span><span style="color: #949494;"> &lt;dbl&gt;, </span><span style="color: #949494; font-weight: bold;">num_graduates_prop</span><span style="color: #949494;"> &lt;dbl&gt;, …</span></span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="model-diagnostics">Model diagnostics<a class="anchor" aria-label="anchor" href="#model-diagnostics"></a>
</h3>
<p>First, we’ll plot the residuals (that is,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mrow><mi>t</mi><mi>i</mi><mi>j</mi><mi>k</mi></mrow></msub><mo>−</mo><msub><mover><mi>y</mi><mo accent="true">̂</mo></mover><mrow><mi>t</mi><mi>i</mi><mi>j</mi><mi>k</mi></mrow></msub></mrow><annotation encoding="application/x-tex">y_{tijk} - \widehat{y}_{tijk}</annotation></semantics></math>)
against the fitted values
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mover><mi>y</mi><mo accent="true">̂</mo></mover><mrow><mi>t</mi><mi>i</mi><mi>j</mi><mi>k</mi></mrow></msub><annotation encoding="application/x-tex">\widehat{y}_{tijk}</annotation></semantics></math>).</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">3</span>, <span class="fl">1.2</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://hardhat.tidymodels.org/reference/hardhat-extract.html" class="external-link">extract_fit_engine</a></span><span class="op">(</span><span class="va">wf_linreg</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="panel-data_files/figure-html/lienarreg-resid-plot-1.png" width="90%" style="display: block; margin: auto;"></p>
<p>The fitted values vs. residuals plot shows us that the residuals are
mostly clustered around zero, but do not form an even band around the
zero line, indicating that the variance of the residuals is not
constant. Additionally, the fitted values vs. square root of
standardized residuals makes this more obvious - the spread of the
square root of standardized residuals varies with the fitted values.</p>
<p>The Q-Q plot shows us that the residuals have heavier tails than a
Normal distribution. So the normality of residuals assumption doesn’t
hold either.</p>
<p>Finally, the residuals vs. leverage plot shows us that we have a few
influential points based on the Cook’s distance (those outside the red
dotted line).</p>
<p>Since we appear to be violating the linear model assumptions, we
might consider transforming our data differently, or considering a
non-linear model, or something else.</p>
</div>
</div>
<div class="section level2">
<h2 id="ar-model-with-exogenous-inputs">AR model with exogenous inputs<a class="anchor" aria-label="anchor" href="#ar-model-with-exogenous-inputs"></a>
</h2>
<p>Now suppose we want to model the 1-step-ahead 5-year employment
income using current and two previous values, while also incorporating
information from the other two time-series in our dataset: the 2-year
employment income and the number of graduates in the previous 2 years.
We would do this using an autoregressive model with exogenous inputs,
defined as follows:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>y</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn><mo>,</mo><mi>i</mi><mi>j</mi><mi>k</mi></mrow></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msub><mi>α</mi><mn>0</mn></msub><mo>+</mo><msub><mi>α</mi><mn>1</mn></msub><msub><mi>y</mi><mrow><mi>t</mi><mi>i</mi><mi>j</mi><mi>k</mi></mrow></msub><mo>+</mo><msub><mi>α</mi><mn>2</mn></msub><msub><mi>y</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn><mo>,</mo><mi>i</mi><mi>j</mi><mi>k</mi></mrow></msub><mo>+</mo><msub><mi>α</mi><mn>3</mn></msub><msub><mi>y</mi><mrow><mi>t</mi><mo>−</mo><mn>2</mn><mo>,</mo><mi>i</mi><mi>j</mi><mi>k</mi></mrow></msub></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mspace width="1.0em"></mspace><mo>+</mo><msub><mi>β</mi><mn>1</mn></msub><msub><mi>x</mi><mrow><mi>t</mi><mi>i</mi><mi>j</mi><mi>k</mi></mrow></msub><mo>+</mo><msub><mi>β</mi><mn>2</mn></msub><msub><mi>x</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn><mo>,</mo><mi>i</mi><mi>j</mi><mi>k</mi></mrow></msub></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mspace width="1.0em"></mspace><mo>+</mo><msub><mi>γ</mi><mn>2</mn></msub><msub><mi>z</mi><mrow><mi>t</mi><mi>i</mi><mi>j</mi><mi>k</mi></mrow></msub><mo>+</mo><msub><mi>γ</mi><mn>2</mn></msub><msub><mi>z</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn><mo>,</mo><mi>i</mi><mi>j</mi><mi>k</mi></mrow></msub><mo>+</mo><msub><mi>ϵ</mi><mrow><mi>t</mi><mi>i</mi><mi>j</mi><mi>k</mi></mrow></msub></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{aligned}
  y_{t+1,ijk} &amp;=
  \alpha_0 + \alpha_1 y_{tijk} + \alpha_2 y_{t-1,ijk} + \alpha_3 y_{t-2,ijk}\\
  &amp;\quad + \beta_1 x_{tijk} + \beta_2 x_{t-1,ijk}\\
  &amp;\quad + \gamma_2 z_{tijk} + \gamma_2 z_{t-1,ijk} + \epsilon_{tijk}
\end{aligned}
</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>y</mi><mrow><mi>t</mi><mi>i</mi><mi>j</mi><mi>k</mi></mrow></msub><annotation encoding="application/x-tex">y_{tijk}</annotation></semantics></math>
is the 5-year median income (proportion) at time
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>
(in location
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>,
age group
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>
with education quality
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>),
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>x</mi><mrow><mi>t</mi><mi>i</mi><mi>j</mi><mi>k</mi></mrow></msub><annotation encoding="application/x-tex">x_{tijk}</annotation></semantics></math>
is the 2-year median income (proportion) at time
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>,
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>z</mi><mrow><mi>t</mi><mi>i</mi><mi>j</mi><mi>k</mi></mrow></msub><annotation encoding="application/x-tex">z_{tijk}</annotation></semantics></math>
is the number of graduates (proportion) at time
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>.</p>
<div class="section level3">
<h3 id="pre-processing-1">Pre-processing<a class="anchor" aria-label="anchor" href="#pre-processing-1"></a>
</h3>
<p>Again, we construct an <code>epi_recipe</code> detailing the
pre-processing steps.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rx</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/epi_recipe.html">epi_recipe</a></span><span class="op">(</span><span class="va">employ_small</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/step_epi_shift.html">step_epi_ahead</a></span><span class="op">(</span><span class="va">med_income_5y_prop</span>, ahead <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="co"># 5-year median income has current, and two lags c(0, 1, 2)</span></span>
<span>  <span class="fu"><a href="../reference/step_epi_shift.html">step_epi_lag</a></span><span class="op">(</span><span class="va">med_income_5y_prop</span>, lag <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="co"># But the two exogenous variables have current values, and 1 lag c(0, 1)</span></span>
<span>  <span class="fu"><a href="../reference/step_epi_shift.html">step_epi_lag</a></span><span class="op">(</span><span class="va">med_income_2y_prop</span>, lag <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/step_epi_shift.html">step_epi_lag</a></span><span class="op">(</span><span class="va">num_graduates_prop</span>, lag <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/step_epi_naomit.html">step_epi_naomit</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">bake_and_show_sample</span><span class="op">(</span><span class="va">rx</span>, <span class="va">employ_small</span><span class="op">)</span></span>
<span><span class="co">#&gt; An `epi_df` object, 5 x 18 with metadata:</span></span>
<span><span class="co">#&gt; * geo_type  = custom</span></span>
<span><span class="co">#&gt; * time_type = integer</span></span>
<span><span class="co">#&gt; * other_keys = age_group, edu_qual</span></span>
<span><span class="co">#&gt; * as_of     = 2024-09-18</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 5 × 18</span></span></span>
<span><span class="co">#&gt;   <span style="font-weight: bold;">geo_value</span>           <span style="font-weight: bold;">age_group</span>      <span style="font-weight: bold;">edu_qual</span>        <span style="font-weight: bold;">time_value</span> <span style="font-weight: bold;">num_graduates</span></span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>               <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>                <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Prince Edward Isla… 35 to 64 years Undergraduate …       <span style="text-decoration: underline;">2</span>017            10</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> British Columbia    35 to 64 years Post-baccalaur…       <span style="text-decoration: underline;">2</span>014           180</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> Alberta             35 to 64 years Career, techni…       <span style="text-decoration: underline;">2</span>016          <span style="text-decoration: underline;">1</span>250</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> Saskatchewan        15 to 34 years Undergraduate …       <span style="text-decoration: underline;">2</span>015          <span style="text-decoration: underline;">2</span>600</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> Saskatchewan        15 to 34 years Doctoral degree       <span style="text-decoration: underline;">2</span>016            70</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 13 more variables: </span><span style="color: #949494; font-weight: bold;">med_income_2y</span><span style="color: #949494;"> &lt;dbl&gt;, </span><span style="color: #949494; font-weight: bold;">med_income_5y</span><span style="color: #949494;"> &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   </span><span style="color: #949494; font-weight: bold;">num_graduates_prop</span><span style="color: #949494;"> &lt;dbl&gt;, </span><span style="color: #949494; font-weight: bold;">med_income_2y_prop</span><span style="color: #949494;"> &lt;dbl&gt;, …</span></span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="model-estimation-post-processing">Model estimation &amp; post-processing<a class="anchor" aria-label="anchor" href="#model-estimation-post-processing"></a>
</h3>
<p>Before estimating our model and making predictions, let’s add some
post-processing steps using a few <a href="https://cmu-delphi.github.io/epipredict/reference/frosting.html"><code>frosting</code></a>
layers to do a few things:</p>
<ol style="list-style-type: decimal">
<li>Threshold our predictions to 0. We are predicting proportions, which
can’t be negative. And the transformed values back to dollars and people
can’t be negative either.</li>
<li>Generate prediction intervals based on residual quantiles, allowing
us to quantify the uncertainty associated with future predicted
values.</li>
<li>Convert our predictions back to income values and number of
graduates, rather than standardized proportions. We do this via the
frosting layer <code><a href="../reference/layer_population_scaling.html">layer_population_scaling()</a></code>.</li>
</ol>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create dataframe of the sums we used for standardizing</span></span>
<span><span class="co"># Only have to include med_income_5y since that is our outcome</span></span>
<span><span class="va">totals</span> <span class="op">&lt;-</span> <span class="va">employ_small</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">geo_value</span>, <span class="va">age_group</span>, <span class="va">edu_qual</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>med_income_5y_tot <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">med_income_5y</span><span class="op">)</span>, .groups <span class="op">=</span> <span class="st">"drop"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Define post-processing steps</span></span>
<span><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/frosting.html">frosting</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/layer_predict.html">layer_predict</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/layer_naomit.html">layer_naomit</a></span><span class="op">(</span><span class="va">.pred</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/layer_threshold.html">layer_threshold</a></span><span class="op">(</span><span class="va">.pred</span>, lower <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="co"># 90% prediction interval</span></span>
<span>  <span class="fu"><a href="../reference/layer_residual_quantiles.html">layer_residual_quantiles</a></span><span class="op">(</span></span>
<span>    symmetrize <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/layer_population_scaling.html">layer_population_scaling</a></span><span class="op">(</span></span>
<span>    <span class="va">.pred</span>, <span class="va">.pred_distn</span>,</span>
<span>    df <span class="op">=</span> <span class="va">totals</span>, df_pop_col <span class="op">=</span> <span class="st">"med_income_5y_tot"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">wfx_linreg</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/epi_workflow.html">epi_workflow</a></span><span class="op">(</span><span class="va">rx</span>, <span class="fu">parsnip</span><span class="fu">::</span><span class="fu"><a href="https://parsnip.tidymodels.org/reference/linear_reg.html" class="external-link">linear_reg</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="va">employ_small</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/add_frosting.html">add_frosting</a></span><span class="op">(</span><span class="va">f</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="https://hardhat.tidymodels.org/reference/hardhat-extract.html" class="external-link">extract_fit_engine</a></span><span class="op">(</span><span class="va">wfx_linreg</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; stats::lm(formula = ..y ~ ., data = data)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;       Min        1Q    Median        3Q       Max </span></span>
<span><span class="co">#&gt; -0.049668 -0.004509 -0.000516  0.004707  0.049882 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;                           Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)               0.041278   0.004975   8.298 4.72e-16 ***</span></span>
<span><span class="co">#&gt; lag_0_med_income_5y_prop  0.320780   0.049348   6.500 1.44e-10 ***</span></span>
<span><span class="co">#&gt; lag_1_med_income_5y_prop  0.079610   0.049116   1.621  0.10546    </span></span>
<span><span class="co">#&gt; lag_2_med_income_5y_prop  0.073048   0.033686   2.168  0.03043 *  </span></span>
<span><span class="co">#&gt; lag_0_med_income_2y_prop  0.118122   0.045579   2.592  0.00973 ** </span></span>
<span><span class="co">#&gt; lag_1_med_income_2y_prop  0.034455   0.042749   0.806  0.42050    </span></span>
<span><span class="co">#&gt; lag_0_num_graduates_prop -0.025129   0.013603  -1.847  0.06509 .  </span></span>
<span><span class="co">#&gt; lag_1_num_graduates_prop  0.078268   0.013396   5.842 7.58e-09 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 0.01056 on 773 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.3224, Adjusted R-squared:  0.3163 </span></span>
<span><span class="co">#&gt; F-statistic: 52.54 on 7 and 773 DF,  p-value: &lt; 2.2e-16</span></span></code></pre></div>
<p>Based on the summary output for this model, we can examine confidence
intervals and perform hypothesis tests as usual.</p>
<p>Let’s take a look at the predictions along with their 90% prediction
intervals.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">latest</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_test_data.html">get_test_data</a></span><span class="op">(</span>recipe <span class="op">=</span> <span class="va">rx</span>, x <span class="op">=</span> <span class="va">employ_small</span><span class="op">)</span></span>
<span><span class="va">predsx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">wfx_linreg</span>, <span class="va">latest</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display predictions along with prediction intervals</span></span>
<span><span class="va">predsx</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span></span>
<span>    <span class="va">geo_value</span>, <span class="va">time_value</span>, <span class="va">edu_qual</span>, <span class="va">age_group</span>,</span>
<span>    <span class="va">.pred_scaled</span>, <span class="va">.pred_distn_scaled</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/pivot_quantiles.html">pivot_quantiles_wider</a></span><span class="op">(</span><span class="va">.pred_distn_scaled</span><span class="op">)</span></span>
<span><span class="co">#&gt; An `epi_df` object, 6 x 12 with metadata:</span></span>
<span><span class="co">#&gt; * geo_type  = custom</span></span>
<span><span class="co">#&gt; * time_type = integer</span></span>
<span><span class="co">#&gt; * other_keys = age_group, edu_qual</span></span>
<span><span class="co">#&gt; * as_of     = 2024-09-18</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 12</span></span></span>
<span><span class="co">#&gt;   <span style="font-weight: bold;">geo_value</span>            <span style="font-weight: bold;">time_value</span> <span style="font-weight: bold;">edu_qual</span>        <span style="font-weight: bold;">age_group</span>      <span style="font-weight: bold;">.pred_scaled</span></span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>                 <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Newfoundland and La…       <span style="text-decoration: underline;">2</span>017 Career, techni… 15 to 34 years       <span style="text-decoration: underline;">45</span>724.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Newfoundland and La…       <span style="text-decoration: underline;">2</span>017 Career, techni… 35 to 64 years       <span style="text-decoration: underline;">37</span>614.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> Newfoundland and La…       <span style="text-decoration: underline;">2</span>017 Career, techni… 15 to 34 years       <span style="text-decoration: underline;">56</span>992.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> Newfoundland and La…       <span style="text-decoration: underline;">2</span>017 Career, techni… 35 to 64 years       <span style="text-decoration: underline;">47</span>802.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> Newfoundland and La…       <span style="text-decoration: underline;">2</span>017 Post career, t… 15 to 34 years       <span style="text-decoration: underline;">61</span>127.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> Newfoundland and La…       <span style="text-decoration: underline;">2</span>017 Undergraduate … 15 to 34 years       <span style="text-decoration: underline;">72</span>713.</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 7 more variables: </span><span style="color: #949494; font-weight: bold;">`0.05`</span><span style="color: #949494;"> &lt;dbl&gt;, </span><span style="color: #949494; font-weight: bold;">`0.1`</span><span style="color: #949494;"> &lt;dbl&gt;, </span><span style="color: #949494; font-weight: bold;">`0.25`</span><span style="color: #949494;"> &lt;dbl&gt;, </span><span style="color: #949494; font-weight: bold;">`0.5`</span><span style="color: #949494;"> &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   </span><span style="color: #949494; font-weight: bold;">`0.75`</span><span style="color: #949494;"> &lt;dbl&gt;, </span><span style="color: #949494; font-weight: bold;">`0.9`</span><span style="color: #949494;"> &lt;dbl&gt;, </span><span style="color: #949494; font-weight: bold;">`0.95`</span><span style="color: #949494;"> &lt;dbl&gt;</span></span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="using-canned-forecasters">Using canned forecasters<a class="anchor" aria-label="anchor" href="#using-canned-forecasters"></a>
</h2>
<p>We’ve seen what we can do with non-epidemiological panel data using
the recipes frame, with <code>epi_recipe</code> for pre-processing,
<code>epi_workflow</code> for model fitting, and <code>frosting</code>
for post-processing.</p>
<p><code>epipredict</code> also comes with canned forecasters that do
all of those steps behind the scenes for some simple models. Even though
we aren’t working with epidemiological data, canned forecasters still
work as expected, out of the box. We will demonstrate this with the
simple <a href="https://cmu-delphi.github.io/epipredict/reference/flatline_forecaster.html"><code>flatline_forecaster</code></a>
and the direct autoregressive (AR) forecaster <a href="https://cmu-delphi.github.io/epipredict/reference/arx_forecaster.html"><code>arx_forecaster</code></a>.</p>
<p>For both illustrations, we will continue to use the
<code>employ_small</code> dataset with the transformed numeric columns
that are proportions within each group by the keys in our
<code>epi_df</code>.</p>
<div class="section level3">
<h3 id="flatline-forecaster">Flatline forecaster<a class="anchor" aria-label="anchor" href="#flatline-forecaster"></a>
</h3>
<p>In this first example, we’ll use <code>flatline_forecaster</code> to
make a simple prediction of the 2-year median income for the next year,
based on one previous time point. This model is representated
algebraically as:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn><mo>,</mo><mi>i</mi><mi>j</mi><mi>k</mi></mrow></msub><mo>=</mo><msub><mi>y</mi><mrow><mi>t</mi><mi>i</mi><mi>j</mi><mi>k</mi></mrow></msub><mo>+</mo><msub><mi>ϵ</mi><mrow><mi>t</mi><mi>i</mi><mi>j</mi><mi>k</mi></mrow></msub></mrow><annotation encoding="application/x-tex">y_{t+1,ijk} = y_{tijk} + \epsilon_{tijk}</annotation></semantics></math>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>y</mi><mrow><mi>t</mi><mi>i</mi><mi>j</mi><mi>k</mi></mrow></msub><annotation encoding="application/x-tex">y_{tijk}</annotation></semantics></math>
is the 2-year median income (proportion) at time
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out_fl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/flatline_forecaster.html">flatline_forecaster</a></span><span class="op">(</span><span class="va">employ_small</span>, <span class="st">"med_income_2y_prop"</span>,</span>
<span>  args_list <span class="op">=</span> <span class="fu"><a href="../reference/flatline_args_list.html">flatline_args_list</a></span><span class="op">(</span>ahead <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">out_fl</span></span>
<span><span class="co">#&gt; ══ A basic forecaster of type flatline ══════════════════════════════════════</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; This forecaster was fit on <span style="color: #00BB00;">2025-09-19 18:33:02</span>.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Training data was an <span style="color: #0000BB;">&lt;epi_df&gt;</span> with:</span></span>
<span><span class="co">#&gt; • Geography: <span style="color: #00BB00;">custom</span>,</span></span>
<span><span class="co">#&gt; • Other keys: <span style="color: #00BB00;">age_group</span> and <span style="color: #00BB00;">edu_qual</span>,</span></span>
<span><span class="co">#&gt; • Time type: <span style="color: #00BB00;">integer</span>,</span></span>
<span><span class="co">#&gt; • Using data up-to-date as of: <span style="color: #00BB00;">2024-09-18</span>.</span></span>
<span><span class="co">#&gt; • With the last data available on <span style="color: #00BB00;">2017</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── Predictions ──────────────────────────────────────────────────────────────</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; A total of <span style="color: #0000BB;">167</span> predictions are available for</span></span>
<span><span class="co">#&gt; • <span style="color: #0000BB;">11</span> unique geographic regions,</span></span>
<span><span class="co">#&gt; • At forecast dates: <span style="color: #0000BB;">2017</span>,</span></span>
<span><span class="co">#&gt; • For target dates: <span style="color: #0000BB;">2018</span>,</span></span>
<span><span class="co">#&gt; </span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="autoregressive-forecaster-with-exogenous-inputs">Autoregressive forecaster with exogenous inputs<a class="anchor" aria-label="anchor" href="#autoregressive-forecaster-with-exogenous-inputs"></a>
</h3>
<p>In this second example, we’ll use <code>arx_forecaster</code> to make
a prediction of the 5-year median income based using two lags,
<em>and</em> using two lags on two exogenous variables: 2-year median
income and number of graduates.</p>
<p>The canned forecaster gives us a simple way of making this forecast
since it defines the recipe, workflow, and post-processing steps behind
the scenes. This is very similar to the model we introduced in the
“Autoregressive Linear Model with Exogenous Inputs” section of this
article, but where all inputs have the same number of lags.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">arx_args</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/arx_args_list.html">arx_args_list</a></span><span class="op">(</span>lags <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0L</span>, <span class="fl">1L</span><span class="op">)</span>, ahead <span class="op">=</span> <span class="fl">1L</span><span class="op">)</span></span>
<span></span>
<span><span class="va">out_arx_lr</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/arx_forecaster.html">arx_forecaster</a></span><span class="op">(</span><span class="va">employ_small</span>, <span class="st">"med_income_5y_prop"</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"med_income_5y_prop"</span>, <span class="st">"med_income_2y_prop"</span>, <span class="st">"num_graduates_prop"</span><span class="op">)</span>,</span>
<span>  args_list <span class="op">=</span> <span class="va">arx_args</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">out_arx_lr</span></span>
<span><span class="co">#&gt; ══ A basic forecaster of type ARX Forecaster ════════════════════════════════</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; This forecaster was fit on <span style="color: #00BB00;">2025-09-19 18:33:03</span>.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Training data was an <span style="color: #0000BB;">&lt;epi_df&gt;</span> with:</span></span>
<span><span class="co">#&gt; • Geography: <span style="color: #00BB00;">custom</span>,</span></span>
<span><span class="co">#&gt; • Other keys: <span style="color: #00BB00;">age_group</span> and <span style="color: #00BB00;">edu_qual</span>,</span></span>
<span><span class="co">#&gt; • Time type: <span style="color: #00BB00;">integer</span>,</span></span>
<span><span class="co">#&gt; • Using data up-to-date as of: <span style="color: #00BB00;">2024-09-18</span>.</span></span>
<span><span class="co">#&gt; • With the last data available on <span style="color: #00BB00;">2017</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── Predictions ──────────────────────────────────────────────────────────────</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; A total of <span style="color: #0000BB;">166</span> predictions are available for</span></span>
<span><span class="co">#&gt; • <span style="color: #0000BB;">11</span> unique geographic regions,</span></span>
<span><span class="co">#&gt; • At forecast dates: <span style="color: #0000BB;">2017</span>,</span></span>
<span><span class="co">#&gt; • For target dates: <span style="color: #0000BB;">2018</span>,</span></span>
<span><span class="co">#&gt; </span></span></code></pre></div>
<p>Other changes to the direct AR forecaster, like changing the engine,
also work as expected. Below we use a boosted tree model instead of a
linear regression.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out_arx_rf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/arx_forecaster.html">arx_forecaster</a></span><span class="op">(</span></span>
<span>  <span class="va">employ_small</span>, <span class="st">"med_income_5y_prop"</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"med_income_5y_prop"</span>, <span class="st">"med_income_2y_prop"</span>, <span class="st">"num_graduates_prop"</span><span class="op">)</span>,</span>
<span>  trainer <span class="op">=</span> <span class="fu">parsnip</span><span class="fu">::</span><span class="fu"><a href="https://parsnip.tidymodels.org/reference/boost_tree.html" class="external-link">boost_tree</a></span><span class="op">(</span>mode <span class="op">=</span> <span class="st">"regression"</span>, trees <span class="op">=</span> <span class="fl">20</span><span class="op">)</span>,</span>
<span>  args_list <span class="op">=</span> <span class="va">arx_args</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">out_arx_rf</span></span>
<span><span class="co">#&gt; ══ A basic forecaster of type ARX Forecaster ════════════════════════════════</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; This forecaster was fit on <span style="color: #00BB00;">2025-09-19 18:33:05</span>.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Training data was an <span style="color: #0000BB;">&lt;epi_df&gt;</span> with:</span></span>
<span><span class="co">#&gt; • Geography: <span style="color: #00BB00;">custom</span>,</span></span>
<span><span class="co">#&gt; • Other keys: <span style="color: #00BB00;">age_group</span> and <span style="color: #00BB00;">edu_qual</span>,</span></span>
<span><span class="co">#&gt; • Time type: <span style="color: #00BB00;">integer</span>,</span></span>
<span><span class="co">#&gt; • Using data up-to-date as of: <span style="color: #00BB00;">2024-09-18</span>.</span></span>
<span><span class="co">#&gt; • With the last data available on <span style="color: #00BB00;">2017</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── Predictions ──────────────────────────────────────────────────────────────</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; A total of <span style="color: #0000BB;">166</span> predictions are available for</span></span>
<span><span class="co">#&gt; • <span style="color: #0000BB;">11</span> unique geographic regions,</span></span>
<span><span class="co">#&gt; • At forecast dates: <span style="color: #0000BB;">2017</span>,</span></span>
<span><span class="co">#&gt; • For target dates: <span style="color: #0000BB;">2018</span>,</span></span>
<span><span class="co">#&gt; </span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="conclusion">Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a>
</h2>
<p>While the purpose of <a href="https://github.com/cmu-delphi/epipredict/" class="external-link">epipredict</a> is to allow
<a href="https://tidymodels.tidymodels.org" class="external-link">tidymodels</a> to operate on epidemiology data, it can be
easily adapted (both the workflows and the canned forecasters) to work
for generic panel data modelling.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p><a href="https://delphi.cmu.edu/about/" class="external-link">About Delphi</a> • <a href="https://delphi.cmu.edu/epidemic-signals/terms-of-use/" class="external-link">Terms of Use</a> • <a href="https://docs.google.com/forms/u/1/d/e/1FAIpQLScqgT1fKZr5VWBfsaSp-DNaN03aV6EoZU4YljIzHJ1Wl_zmtg/viewform" class="external-link">Contact Us</a> • <a href="https://github.com/cmu-delphi/" class="external-link">Delphi GitHub</a> • <a href="https://cmu-delphi.github.io/delphi-epidata/" class="external-link">Epidata API</a></p>
</div>

<div class="pkgdown-footer-right">
  <p>epipredict</p>
</div>

    </footer>
</div>





  </body>
</html>
