<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Basic epidemiology forecasting methods • epipredict</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/Open_Sans-0.4.9/font.css" rel="stylesheet">
<link href="deps/Source_Serif_Pro-0.4.9/font.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Basic epidemiology forecasting methods">
<meta name="description" content='A forecasting "framework" for creating epidemiological forecasts from versioned data. The framework is designed to be modular so that different components can exchanged, enabling a large amount of flexibility. Some simple baseline models formed from these components are included.'>
<meta property="og:description" content='A forecasting "framework" for creating epidemiological forecasts from versioned data. The framework is designed to be modular so that different components can exchanged, enabling a large amount of flexibility. Some simple baseline models formed from these components are included.'>
<meta name="robots" content="noindex">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">epipredict</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">0.1.13</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="articles/epipredict.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="articles/preprocessing-and-models.html">Examples of Preprocessing and Models</a></li>
    <li><a class="dropdown-item" href="articles/backtesting.html">Accurately backtesting forecasters</a></li>
    <li><a class="dropdown-item" href="articles/arx-classifier.html">Auto-regressive classifier</a></li>
    <li><a class="dropdown-item" href="articles/update.html">Using the add/update/remove and adjust functions</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="articles/index.html">More articles...</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/cmu-delphi/epipredict/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="epipredict">epipredict<a class="anchor" aria-label="anchor" href="#epipredict"></a>
</h1></div>
<!-- badges: start -->

<p><strong>Note:</strong> This package is currently in development and may not work as expected. Please file bug reports as issues in this repo, and we will do our best to address them quickly.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>To install (unless you’re making changes to the package, use the stable version):</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Stable version</span></span>
<span><span class="fu">pak</span><span class="fu">::</span><span class="fu"><a href="https://pak.r-lib.org/reference/pkg_install.html" class="external-link">pkg_install</a></span><span class="op">(</span><span class="st">"cmu-delphi/epipredict@main"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Dev version</span></span>
<span><span class="fu">pak</span><span class="fu">::</span><span class="fu"><a href="https://pak.r-lib.org/reference/pkg_install.html" class="external-link">pkg_install</a></span><span class="op">(</span><span class="st">"cmu-delphi/epipredict@dev"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="documentation">Documentation<a class="anchor" aria-label="anchor" href="#documentation"></a>
</h2>
<p>You can view documentation for the <code>main</code> branch at <a href="https://cmu-delphi.github.io/epipredict" class="uri">https://cmu-delphi.github.io/epipredict</a>.</p>
</div>
<div class="section level2">
<h2 id="goals-for-epipredict">Goals for <code>epipredict</code>
<a class="anchor" aria-label="anchor" href="#goals-for-epipredict"></a>
</h2>
<p><strong>We hope to provide:</strong></p>
<ol style="list-style-type: decimal">
<li>A set of basic, easy-to-use forecasters that work out of the box. You should be able to do a reasonably limited amount of customization on them. For the basic forecasters, we currently provide:
<ul>
<li>Baseline flatline forecaster</li>
<li>Autoregressive forecaster</li>
<li>Autoregressive classifier</li>
<li>CDC FluSight flatline forecaster</li>
</ul>
</li>
<li>A framework for creating custom forecasters out of modular components. There are four types of components:
<ul>
<li>Preprocessor: do things to the data before model training</li>
<li>Trainer: train a model on data, resulting in a fitted model object</li>
<li>Predictor: make predictions, using a fitted model object</li>
<li>Postprocessor: do things to the predictions before returning</li>
</ul>
</li>
</ol>
<p><strong>Target audiences:</strong></p>
<ul>
<li>Basic. Has data, calls forecaster with default arguments.</li>
<li>Intermediate. Wants to examine changes to the arguments, take advantage of built in flexibility.</li>
<li>Advanced. Wants to write their own forecasters. Maybe willing to build up from some components.</li>
</ul>
<p>The Advanced user should find their task to be relatively easy. Examples of these tasks are illustrated in the <a href="https://cmu-delphi.github.io/epipredict">vignettes and articles</a>.</p>
<p>See also the (in progress) <a href="https://cmu-delphi.github.io/delphi-tooling-book/" class="external-link">Forecasting Book</a>.</p>
</div>
<div class="section level2">
<h2 id="intermediate-example">Intermediate example<a class="anchor" aria-label="anchor" href="#intermediate-example"></a>
</h2>
<p>The package comes with some built-in historical data for illustration, but up-to-date versions of this could be downloaded with the <a href="https://cmu-delphi.github.io/epidatr/" class="external-link"><code>{epidatr}</code> package</a> and processed using <a href="https://cmu-delphi.github.io/epiprocess/" class="external-link"><code>{epiprocess}</code></a>.<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;Other epidemiological signals for non-Covid related illnesses are also available with &lt;a href="https://github.com/cmu-delphi/epidatr" class="external-link"&gt;&lt;code&gt;{epidatr}&lt;/code&gt;&lt;/a&gt; which interfaces directly to Delphi’s &lt;a href="https://cmu-delphi.github.io/delphi-epidata/" class="external-link"&gt;Epidata API&lt;/a&gt;&lt;/p&gt;'><sup>1</sup></a></p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/cmu-delphi/epipredict/" class="external-link">epipredict</a></span><span class="op">)</span></span>
<span><span class="va">covid_case_death_rates</span></span>
<span><span class="co">#&gt; An `epi_df` object, 20,496 x 4 with metadata:</span></span>
<span><span class="co">#&gt; * geo_type  = state</span></span>
<span><span class="co">#&gt; * time_type = day</span></span>
<span><span class="co">#&gt; * as_of     = 2023-03-10</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # A tibble: 20,496 × 4</span></span>
<span><span class="co">#&gt;    geo_value time_value case_rate death_rate</span></span>
<span><span class="co">#&gt;  * &lt;chr&gt;     &lt;date&gt;         &lt;dbl&gt;      &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1 ak        2020-12-31      35.9      0.158</span></span>
<span><span class="co">#&gt;  2 al        2020-12-31      65.1      0.438</span></span>
<span><span class="co">#&gt;  3 ar        2020-12-31      66.0      1.27 </span></span>
<span><span class="co">#&gt;  4 as        2020-12-31       0        0    </span></span>
<span><span class="co">#&gt;  5 az        2020-12-31      76.8      1.10 </span></span>
<span><span class="co">#&gt;  6 ca        2020-12-31      95.9      0.755</span></span>
<span><span class="co">#&gt;  7 co        2020-12-31      37.8      0.376</span></span>
<span><span class="co">#&gt;  8 ct        2020-12-31      52.1      0.819</span></span>
<span><span class="co">#&gt;  9 dc        2020-12-31      31.0      0.601</span></span>
<span><span class="co">#&gt; 10 de        2020-12-31      64.3      0.912</span></span>
<span><span class="co">#&gt; # ℹ 20,486 more rows</span></span></code></pre></div>
<p>To create and train a simple auto-regressive forecaster to predict the death rate two weeks into the future using past (lagged) deaths and cases, we could use the following function.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">two_week_ahead</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/arx_forecaster.html">arx_forecaster</a></span><span class="op">(</span></span>
<span>  <span class="va">covid_case_death_rates</span>,</span>
<span>  outcome <span class="op">=</span> <span class="st">"death_rate"</span>,</span>
<span>  predictors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"case_rate"</span>, <span class="st">"death_rate"</span><span class="op">)</span>,</span>
<span>  args_list <span class="op">=</span> <span class="fu"><a href="reference/arx_args_list.html">arx_args_list</a></span><span class="op">(</span></span>
<span>    lags <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">7</span>, <span class="fl">14</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">7</span>, <span class="fl">14</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    ahead <span class="op">=</span> <span class="fl">14</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">two_week_ahead</span></span>
<span><span class="co">#&gt; ══ A basic forecaster of type ARX Forecaster ═══════════════════════════════</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; This forecaster was fit on 2025-02-11 12:32:56.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Training data was an &lt;epi_df&gt; with:</span></span>
<span><span class="co">#&gt; • Geography: state,</span></span>
<span><span class="co">#&gt; • Time type: day,</span></span>
<span><span class="co">#&gt; • Using data up-to-date as of: 2023-03-10.</span></span>
<span><span class="co">#&gt; • With the last data available on 2021-12-31</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── Predictions ─────────────────────────────────────────────────────────────</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; A total of 56 predictions are available for</span></span>
<span><span class="co">#&gt; • 56 unique geographic regions,</span></span>
<span><span class="co">#&gt; • At forecast date: 2021-12-31,</span></span>
<span><span class="co">#&gt; • For target date: 2022-01-14,</span></span>
<span><span class="co">#&gt; </span></span></code></pre></div>
<p>In this case, we have used a number of different lags for the case rate, while only using 3 weekly lags for the death rate (as predictors). The result is both a fitted model object which could be used any time in the future to create different forecasts, as well as a set of predicted values (and prediction intervals) for each location 14 days after the last available time value in the data.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">two_week_ahead</span><span class="op">$</span><span class="va">epi_workflow</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ══ Epi Workflow [trained] ══════════════════════════════════════════════════</span></span>
<span><span class="co">#&gt; Preprocessor: Recipe</span></span>
<span><span class="co">#&gt; Model: linear_reg()</span></span>
<span><span class="co">#&gt; Postprocessor: Frosting</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── Preprocessor ────────────────────────────────────────────────────────────</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; 6 Recipe steps.</span></span>
<span><span class="co">#&gt; 1. step_epi_lag()</span></span>
<span><span class="co">#&gt; 2. step_epi_lag()</span></span>
<span><span class="co">#&gt; 3. step_epi_ahead()</span></span>
<span><span class="co">#&gt; 4. step_naomit()</span></span>
<span><span class="co">#&gt; 5. step_naomit()</span></span>
<span><span class="co">#&gt; 6. step_training_window()</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── Model ───────────────────────────────────────────────────────────────────</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; stats::lm(formula = ..y ~ ., data = data)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;       (Intercept)    lag_0_case_rate    lag_1_case_rate    lag_2_case_rate  </span></span>
<span><span class="co">#&gt;        -0.0071026          0.0040340          0.0007863          0.0003699  </span></span>
<span><span class="co">#&gt;   lag_3_case_rate    lag_7_case_rate   lag_14_case_rate   lag_0_death_rate  </span></span>
<span><span class="co">#&gt;         0.0012887          0.0011980          0.0002527          0.1348573  </span></span>
<span><span class="co">#&gt;  lag_7_death_rate  lag_14_death_rate  </span></span>
<span><span class="co">#&gt;         0.1479274          0.1067074</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── Postprocessor ───────────────────────────────────────────────────────────</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; 5 Frosting layers.</span></span>
<span><span class="co">#&gt; 1. layer_predict()</span></span>
<span><span class="co">#&gt; 2. layer_residual_quantiles()</span></span>
<span><span class="co">#&gt; 3. layer_add_forecast_date()</span></span>
<span><span class="co">#&gt; 4. layer_add_target_date()</span></span>
<span><span class="co">#&gt; 5. layer_threshold()</span></span>
<span><span class="co">#&gt; </span></span></code></pre></div>
<p>The fitted model here involved preprocessing the data to appropriately generate lagged predictors, estimating a linear model with <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">stats::lm()</a></code> and then postprocessing the results to be meaningful for epidemiological tasks. We can also examine the predictions.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">two_week_ahead</span><span class="op">$</span><span class="va">predictions</span></span>
<span><span class="co">#&gt; # A tibble: 56 × 5</span></span>
<span><span class="co">#&gt;    geo_value .pred        .pred_distn forecast_date target_date</span></span>
<span><span class="co">#&gt;    &lt;chr&gt;     &lt;dbl&gt;             &lt;dist&gt; &lt;date&gt;        &lt;date&gt;     </span></span>
<span><span class="co">#&gt;  1 ak        0.450 quantiles(0.45)[7] 2021-12-31    2022-01-14 </span></span>
<span><span class="co">#&gt;  2 al        0.602  quantiles(0.6)[7] 2021-12-31    2022-01-14 </span></span>
<span><span class="co">#&gt;  3 ar        0.694 quantiles(0.69)[7] 2021-12-31    2022-01-14 </span></span>
<span><span class="co">#&gt;  4 as        0        quantiles(0)[7] 2021-12-31    2022-01-14 </span></span>
<span><span class="co">#&gt;  5 az        0.699  quantiles(0.7)[7] 2021-12-31    2022-01-14 </span></span>
<span><span class="co">#&gt;  6 ca        0.592 quantiles(0.59)[7] 2021-12-31    2022-01-14 </span></span>
<span><span class="co">#&gt;  7 co        1.47  quantiles(1.47)[7] 2021-12-31    2022-01-14 </span></span>
<span><span class="co">#&gt;  8 ct        1.08  quantiles(1.08)[7] 2021-12-31    2022-01-14 </span></span>
<span><span class="co">#&gt;  9 dc        2.14  quantiles(2.14)[7] 2021-12-31    2022-01-14 </span></span>
<span><span class="co">#&gt; 10 de        1.13  quantiles(1.13)[7] 2021-12-31    2022-01-14 </span></span>
<span><span class="co">#&gt; # ℹ 46 more rows</span></span></code></pre></div>
<p>The results above show a distributional forecast produced using data through the end of 2021 for the 14th of January 2022. A prediction for the death rate per 100K inhabitants is available for every state (<code>geo_value</code>) along with a 90% predictive interval.</p>
</div>
</div>


  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/cmu-delphi/epipredict/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/cmu-delphi/epipredict/issues/" class="external-link">Report a bug</a></li>
<li><a href="https://cmu-delphi.github.io/epiprocess/" class="external-link">The epiprocess package</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing epipredict</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Daniel J. McDonald <br><small class="roles"> Author, maintainer </small>  </li>
<li>Ryan Tibshirani <br><small class="roles"> Author </small>  </li>
<li>Dmitry Shemetov <br><small class="roles"> Author </small>  </li>
<li>David Weber <br><small class="roles"> Author </small>  </li>
<li>Delphi Research Group <br><small class="roles"> Copyright holder, funder </small>  </li>
<li>Logan Brooks <br><small class="roles"> Author </small>  </li>
<li>Rachel Lobay <br><small class="roles"> Author </small>  </li>
<li><a href="authors.html">More about authors...</a></li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/cmu-delphi/epipredict/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/cmu-delphi/epipredict/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
</ul>
</div>

<div class="delphi-packages-and-resources">
<h2 data-toc-skip>Delphi packages and resources</h2>
<ul class="list-unstyled">
<li><ul>
<li><a href="https://github.com/cmu-delphi/epidatr/" class="external-link">The epidatr package</a></li>
<li><a href="https://cmu-delphi.github.io/epiprocess/" class="external-link">The epiprocess package</a></li>
<li><a href="https://cmu-delphi.github.io/epidatasets/" class="external-link">The epidatasets package</a></li>
<li><a href="https://cmu-delphi.github.io/delphi-tooling-book/" class="external-link">Introduction to Delphi’s Tooling Work</a></li>
</ul></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p><a href="https://delphi.cmu.edu/about/" class="external-link">About Delphi</a> • <a href="https://delphi.cmu.edu/epidemic-signals/terms-of-use/" class="external-link">Terms of Use</a> • <a href="https://docs.google.com/forms/u/1/d/e/1FAIpQLScqgT1fKZr5VWBfsaSp-DNaN03aV6EoZU4YljIzHJ1Wl_zmtg/viewform" class="external-link">Contact Us</a> • <a href="https://github.com/cmu-delphi/" class="external-link">Delphi GitHub</a> • <a href="https://cmu-delphi.github.io/delphi-epidata/" class="external-link">Epidata API</a></p>
</div>

<div class="pkgdown-footer-right">
  <p>epipredict</p>
</div>

    </footer>
</div>





  </body>
</html>
